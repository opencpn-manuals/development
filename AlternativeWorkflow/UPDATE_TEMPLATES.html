<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>updates-templates README :: OpenCPN Developer Manual</title>
    <link rel="canonical" href="https://opencpn-manuals.github.io/development/AlternativeWorkflow/UPDATE_TEMPLATES.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
    <script>var uiRootPath = '../_'</script>
  </head>
  <body class="article">
<header class="header">
  <div class="navbar">
    <div class="navbar-brand">
      <div class="ocpn-logo"> </div>
      <a class="navbar-title"
         href="https://opencpn-manuals.github.io/development"
      >
        OpenCPN Developer Manual
        </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
       <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://www.opencpn.org">OpenCPN.org</a>
            <a class="navbar-item"
               href="https://opencpn.org/wiki/dokuwiki/doku.php?id=opencpn:opencpn_user_manual"
            >
               User Manual
               </a>
            <a class="navbar-item" href="https://github.com/opencpn/OpenCPN">
               Github Site
               </a>
            <a class="navbar-item" href="https://opencpn.org/flyspray/">
               Bugtracker
               </a>
            <a class="navbar-item"
                href="https://rasbats.github.io/opencpn-plugins-manual/">
                    Plugin Manual (pre-alpha)
               </a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="AlternativeWorkflow" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Shipdriver Managed Workflow for the OpenCPN plugins</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="Overview.html">Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Metadata-Flow.html">Metadata Files</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Plugin-Adaptation.html">Adapting the Plugin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="usage.html">Local Builds</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Local-Build.html">Build Dependencies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="InstallConfigure.html">CI Services Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="InstallConfigure/GithubPreps.html">Github OpenCPN/plugins fork</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="InstallConfigure/Cloudsmith.html">Cloudsmith</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="InstallConfigure/Builders/IntroBuilders.html">Builders</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="InstallConfigure/Builders/Appveyor.html">Appveyor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="InstallConfigure/Builders/CircleCI.html">CircleCI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="InstallConfigure/Builders/Drone.html">Drone.io</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="InstallConfigure/Builders/Travis.html">Travis</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="InstallConfigure/BuilderEnv.html">Builder environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="InstallConfigure/GitHub.html">Final checks and testing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="InstallConfigure/Catalog-Github-Integration.html">Creating a catalog PR</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Versioning.html">Versioning</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="Useful-Stuff.html">Useful information</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Local-ci-build.html">Local CI builds (experimental)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Shipdriver Managed Workflow for the OpenCPN plugins</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../ocpn-dev-manual/5.3.1/index.html">OpenCPN Developer Manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../ocpn-dev-manual/5.3.1/index.html">5.3.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../opencpn-plugins/0.1/index.html">OpenCPN Plugins</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../opencpn-plugins/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../plugin-installer/0.0.1/Home.html">Plugin Installer Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../plugin-installer/0.0.1/Home.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">Shipdriver Managed Workflow for the OpenCPN plugins</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../ocpn-dev-manual/5.3.1/intro-AboutThisManual.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Shipdriver Managed Workflow for the OpenCPN plugins</a></li>
    <li><a href="UPDATE_TEMPLATES.html">updates-templates README</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/Rasbats/managed_plugins/edit/main/manual/modules/ROOT/pages/UPDATE_TEMPLATES.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">updates-templates README</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The script update-templates can be used to update a plugin with
newer versions of the shipdriver templates. The basic workflow
is to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bootstrap process by downloading the updates-templates script
and add it to repo if it does not exist.</p>
</li>
<li>
<p>Make sure the plugin repo is clean (commit or stash changes)</p>
</li>
<li>
<p>Run script</p>
</li>
<li>
<p>Inspect the results.</p>
</li>
<li>
<p>Handle updates to CMakeLists.txt/Plugin.cmake and the
flatpak yaml manifest.</p>
</li>
<li>
<p>Upstream local changes to shipdriver templates</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bootstrapping"><a class="anchor" href="#_bootstrapping"></a>Bootstrapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Only required if the update script is not yet part of the repo. Once
installed, the script is self-updating.</p>
</div>
<div class="paragraph">
<p>Linux:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cd some_plugin
$ repo=https://raw.githubusercontent.com/Rasbats/shipdriver_pi/master
$ curl $repo/update-templates --output update-templates
$ chmod 755 update-templates
$ git add update-templates
$ git commit -m "Add update-templates script"</pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to use wget instead of curl, like
<code>wget $repo/update-templates</code>. Windows works the same way when using git-bash,
except that the <code>chmod</code> command does not make sense here and hence is omitted.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bootstrap_windows_cmd_com"><a class="anchor" href="#_bootstrap_windows_cmd_com"></a>Bootstrap - Windows (cmd.com)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As in linux, bootstrapping is only required if the script is not yet
available in the plugin repo. Once installed, it&#8217;s self-updating.</p>
</div>
<div class="paragraph">
<p>The script is written in bash, so git-bash is required. Using git-bash, the
script can be downloaded and installed as in linux, see above.</p>
</div>
<div class="paragraph">
<p>Using the Windows command CLI goes like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; cd some_plugin
&gt; set repo=https://raw.githubusercontent.com/Rasbats/shipdriver_pi/master
&gt; curl %repo%/update-templates --output update-templates
&gt; git add update-templates
&gt; git commit -m "Add update-templates script"</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running"><a class="anchor" href="#_running"></a>Running</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The script is run from the plugin top directory using
<code>./update-templates</code>. In windows CMD, assuming standard installation paths:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; "C:\Program Files\Git\bin\bash.exe" update-templates</pre>
</div>
</div>
<div class="paragraph">
<p>Usage summary:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>update-templates [-T] [treeish]
update-templates  -h
update-templates  -l</pre>
</div>
</div>
<div class="paragraph">
<p><strong>treeish</strong> defaults to <em>shipdriver/master</em> i. e., templates are updated
from shipdriver&#8217;s development branch. It could be set to a branch
like <em>shipdriver/v3.0</em> or a tag like <em>sd3.0.0</em> to retrieve data from
corresponding git trees.</p>
</div>
<div class="paragraph">
<p><strong>-l</strong> lists available tags which can be used as <em>treeish</em></p>
</div>
<div class="paragraph">
<p><strong>-T</strong> runs in test mode, lots of output, requires an existing shipdriver
remote and does not self-update.</p>
</div>
<div class="paragraph">
<p><strong>update-templates -h</strong> prints the complete help message.</p>
</div>
<div class="paragraph">
<p>Script unconditionally updates known files and commits them directly.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>update-templates shipdriver/v3.0    -- get updates from v3.0 branch
update-templates sd3.0.0            -- get updates from sd3.0.0 tag
update-templates -l                 -- list all available tags</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The default alternative is (should be) to update to the latest
available tag. The default option using shipdriver/master is
basically for template development.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_checking_modifications_in_cmakelists_txt_and_flatpak_manifest"><a class="anchor" href="#_checking_modifications_in_cmakelists_txt_and_flatpak_manifest"></a>Checking modifications in CMakeLists.txt and flatpak manifest</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As part of the 3.0.0 transition CMakeLists.txt is split into one
plugin-specific file <em>Plugin.cmake</em> and a generic <em>CMakeLists.txt</em>.
Later updates are only supposed to affect <em>CMakeLists.txt</em> while
 <em>Plugin.cmake</em>, the plugin-specific parts is kept as-is.</p>
</div>
<div class="paragraph">
<p>The "flatpak manifest" is the yaml file configuring the flatpak build,
named like flatpak/org.opencpn.OpenCPN.Plugin.\*.yaml.  This might need
to be updated. If there have been changes to the shipdriver manifest
since the last release these are added as comments at the end of the
manifest. Review the file, consider applying corresponding changes to
the manifest and eventually remove the comment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_upstreaming_local_changes_to_shipdriver"><a class="anchor" href="#_upstreaming_local_changes_to_shipdriver"></a>Upstreaming local changes to shipdriver</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If there is a need to modify any of the files updated by update-templates,
please file bugs against the shipdriver repo so the next update runs smoother.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.
     Sources: https://gitlab.com/leamas/antora-ui-default
  </p>
</footer>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
